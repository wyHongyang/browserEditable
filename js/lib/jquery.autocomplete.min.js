
!function(a){a(jQuery)}(function(a){var b=function(c,d){var e=this;this.$el=a(c),this.options=a.extend({},b.defaults,d),e.$el.on("input",function(b){var c=a(b.target).val();c&&e.search(c)}),e.$el.closest(".bd-main").siblings(".u-sch, .u-option").on("click",".sch-item",function(b){var c=a(b.target);e.options.onSelect.call(e,c,e.$el)})};b.defaults={relations:[],limit:10,ajaxUrl:"",isCall:!1,searchVal:"",onSelect:a.noop},b.prototype.search=function(b){var c=this,d=a("<ul />",{"class":"u-val"}),e="";if(b)var f=new RegExp(b,"ig");else var f=/.*/;if(""!=c.options.ajaxUrl||c.options.isCall)c.options.ajaxUrl&&c.options.isCall&&a.ajax({url:c.options.ajaxUrl,type:"GET",data:a.param({searchVal:c.options.searchVal,limit:c.options.limit}),dataType:"json",success:function(b){b.length&&(e=a.map(b,function(a,b){return b<c.options.limit?"<li class='sch-item' data-psw = '"+a.userpassword+"'>"+a.username+"</li>":void 0}))}});else if(c.options.relations.length){for(var g=[],h=0,i=c.options.relations.length;i>h;h++){var j=c.options.relations[h].username.match(f);j&&j.length&&g.push(c.options.relations[h])}e=g.length?a.map(g,function(a,b){return b<c.options.limit?"<li class='sch-item' data-psw = '"+a.userpassword+"'>"+a.username+"</li>":void 0}):"<li class='no-data'>没有找到用户</li>"}else e="<li class='no-data'>没有找到用户</li>";d.append(e),c.$el.closest(".bd-main").siblings(".u-sch").empty().append(d).show()},a.fn.aotocomplete=function(c,d){return this.each(function(){var e=a(this);data=e.data("autocomplete"),data?"string"==typeof d&&data[d](c):(e.data("autocomplete",new b(this,c)),"string"==typeof d&&e.data("autocomplete")[d](c))})}});